<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GitHub Actions 自动化部署 | 尚天竹</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="一个关于前端和后端技术分享和学习的个人博客,坚持原创,坚持分享">
    <meta name="keywords">
    <meta content="GitHub Actions,自动化部署">
    <meta name="theme-color" content="#11a8cd">
    <meta name="google-site-verification" content="44Gv2eab4Ydh_P7X4pKo08S5R3cDlssKzmOg31l0HKI">
    <meta name="baidu-site-verification" content="code-wbe068nyEh">
    <link rel="preload" href="/assets/css/0.styles.a7c389e5.css" as="style"><link rel="preload" href="/assets/js/app.1bf2a7df.js" as="script"><link rel="preload" href="/assets/js/2.ef1a646b.js" as="script"><link rel="preload" href="/assets/js/14.2eb2e1b7.js" as="script"><link rel="prefetch" href="/assets/js/10.f693e768.js"><link rel="prefetch" href="/assets/js/11.df734194.js"><link rel="prefetch" href="/assets/js/12.b5e56c91.js"><link rel="prefetch" href="/assets/js/13.83122073.js"><link rel="prefetch" href="/assets/js/15.06186aa0.js"><link rel="prefetch" href="/assets/js/16.e0c0e925.js"><link rel="prefetch" href="/assets/js/17.1450c9aa.js"><link rel="prefetch" href="/assets/js/18.74604608.js"><link rel="prefetch" href="/assets/js/19.d4594b8e.js"><link rel="prefetch" href="/assets/js/20.a27a4ba9.js"><link rel="prefetch" href="/assets/js/21.534807df.js"><link rel="prefetch" href="/assets/js/22.ea96993f.js"><link rel="prefetch" href="/assets/js/23.a25c0124.js"><link rel="prefetch" href="/assets/js/24.d6bbc26c.js"><link rel="prefetch" href="/assets/js/3.74436d54.js"><link rel="prefetch" href="/assets/js/4.ea5065a0.js"><link rel="prefetch" href="/assets/js/5.11974b38.js"><link rel="prefetch" href="/assets/js/6.278b69ed.js"><link rel="prefetch" href="/assets/js/7.6baca1a6.js"><link rel="prefetch" href="/assets/js/8.2fee6c26.js"><link rel="prefetch" href="/assets/js/9.23046d54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a7c389e5.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">尚天竹</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>VUE</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>uniapp</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8ec53a/" class="nav-link">Vue-Router</a></li><li class="dropdown-subitem"><a href="/pages/eb7fff/" class="nav-link">React基础入门</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/58f0cb/" class="nav-link">Http协议</a></li><li class="dropdown-subitem"><a href="/pages/42e039/" class="nav-link">跨域问题总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/fontend/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>springboot</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>springcloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/e84bbc/" class="nav-link">Mongoose测试</a></li></ul></div></div><div class="nav-item"><a href="/pages/8149d9/" class="nav-link">友链</a></div><div class="nav-item"><a href="https://github.com/yrpyrp1116" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatar-static.segmentfault.com/249/884/2498845138-602fc45007b7c_big64"> <div class="blogger-info"><h3>尚天竹</h3> <span>我也不知道。。。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>VUE</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>uniapp</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8ec53a/" class="nav-link">Vue-Router</a></li><li class="dropdown-subitem"><a href="/pages/eb7fff/" class="nav-link">React基础入门</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/58f0cb/" class="nav-link">Http协议</a></li><li class="dropdown-subitem"><a href="/pages/42e039/" class="nav-link">跨域问题总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/fontend/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>springboot</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><h4>springcloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6abe86/" class="nav-link">构造函数和原型</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/e84bbc/" class="nav-link">Mongoose测试</a></li></ul></div></div><div class="nav-item"><a href="/pages/8149d9/" class="nav-link">友链</a></div><div class="nav-item"><a href="https://github.com/yrpyrp1116" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/pages/3e6e24/" class="sidebar-link">Git的使用</a></li><li><a href="/pages/859e09/" class="sidebar-link">SEO搜索引擎优化</a></li><li><a href="/pages/34b5dd/" class="sidebar-link">常用cmd和linux命令</a></li><li><a href="/pages/eb693b/" class="sidebar-link">Serverless</a></li><li><a href="/pages/6ddf53/" class="sidebar-link">CentOS7安装Nginx</a></li><li><a href="/pages/ee9a19/" aria-current="page" class="active sidebar-link">GitHub Actions 自动化部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ee9a19/#创建最小权限用户" class="sidebar-link">创建最小权限用户</a></li><li class="sidebar-sub-header"><a href="/pages/ee9a19/#创建-ssh-key" class="sidebar-link">创建 SSH-KEY</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ee9a19/#修改-id-rsa-pub-名称" class="sidebar-link">修改 id_rsa.pub 名称</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/ee9a19/#tar-命令" class="sidebar-link">tar 命令</a></li><li class="sidebar-sub-header"><a href="/pages/ee9a19/#编写-ci-yml" class="sidebar-link">编写 ci.yml</a></li></ul></li><li><a href="/pages/667146/" class="sidebar-link">Nginx的使用</a></li><li><a href="/pages/fc6574/" class="sidebar-link">正则表达式</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/other" title="其它-目录页" data-v-1cd794fe>其它</a></li> <!----> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/yrpyrp1116" target="_blank" title="作者" class="beLink" data-v-1cd794fe>尚天竹</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2021-04-04</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          GitHub Actions 自动化部署
        </h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="github-actions-自动化部署"><a href="#github-actions-自动化部署" class="header-anchor">#</a> GitHub Actions 自动化部署</h1> <blockquote><p>参考：<a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html" target="_blank" rel="noopener noreferrer">GitHub Actions 入门教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
参考：<a href="https://docs.github.com/cn/actions/reference/events-that-trigger-workflows" target="_blank" rel="noopener noreferrer">触发工作流程的事件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
参考：<a href="https://docs.github.com/cn/github/authenticating-to-github/creating-a-personal-access-token" target="_blank" rel="noopener noreferrer">创建个人访问令牌<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li>持续集成，类似于 <code>Travis CI</code></li> <li>GitHub 只要发现 <code>.github/workflows</code> 目录里面有 .yml 文件，就会自动运行该文件。</li> <li>编写 .yml 文件，在工作流程中触发的事件中执行相应代码</li></ul> <h2 id="创建最小权限用户"><a href="#创建最小权限用户" class="header-anchor">#</a> 创建最小权限用户</h2> <blockquote><p>只想新建的用户仅对一个文件夹进行读写操作(不开放其它权限)<br>
只需要创建一个最小权限的角色<br>
并仅给其分配单个文件夹的权限<br>
可以防止权限过高造成安全隐患</p></blockquote> <ul><li>Xshell 连接服务器</li> <li><code>su</code> 命令用来切换用户角色</li> <li>切换到 root 用户角色：<code>su root</code>，可能需要输入密码</li> <li>创建用户：<code>useradd [username]</code>, 以创建 au 角色为例(<code>useradd au</code>)，此时创建的 <code>au</code> 用户 默认使用 <code>au</code> 用户组</li> <li>使用 setfacl 设置文件权限： <code>setfacl -m u:[username]:rwx [dirname]</code>，例如：<code>setfacl -m u:au:rwx /usr/web/html/blog</code>（给 au 角色设置 blog 文件的读写执行权限）</li> <li>此时创建的用户仅有 <code>/usr/web/html/blog</code> 文件的读写执行权限</li></ul> <h2 id="创建-ssh-key"><a href="#创建-ssh-key" class="header-anchor">#</a> 创建 SSH-KEY</h2> <ul><li>切换到 <code>au</code> 角色：<code>su au</code>，直接使用最小权限用户生成 SSH-KEY</li> <li>查看是否已经存在：<code>ls -al ~/.ssh</code></li> <li>生成新的 ssh key：<code>ssh-keygen -t rsa</code>, 连续三次回车</li> <li>检测是否生成成功：<code>ls -al ~/.ssh</code></li></ul> <h3 id="修改-id-rsa-pub-名称"><a href="#修改-id-rsa-pub-名称" class="header-anchor">#</a> 修改 id_rsa.pub 名称</h3> <ul><li>通过 au 角色创建好 ssh-key 后，公钥和私钥一般在 <code>/home/au/.ssh</code> 目录下</li> <li>切换到 .ssh 目录：<code>cd /home/au/.ssh</code></li> <li>名字改为 authorized_keys：<code>cat id_rsa.pub &gt;&gt; authorized_keys</code></li> <li>删除 id_rsa.pub：<code>rm id_rsa.pub</code></li></ul> <h2 id="tar-命令"><a href="#tar-命令" class="header-anchor">#</a> tar 命令</h2> <ul><li>压缩: <code>tar -czvf blog.tgz ./*</code></li> <li>解压：<code>tar xzvf blog.tgz</code></li></ul> <h2 id="编写-ci-yml"><a href="#编写-ci-yml" class="header-anchor">#</a> 编写 <code>ci.yml</code></h2> <blockquote><p><a href="https://blog.csdn.net/qq_35374262/article/details/108127204" target="_blank" rel="noopener noreferrer">参考文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://github.com/marketplace/actions/ssh-deploy" target="_blank" rel="noopener noreferrer">ssh-deploy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ol><li>KEY：上一步服务器新建的公钥<code>id_rsa.pub</code>，<code>cat id_rsa.pub</code> 之后复制全部内容</li> <li>HOST：服务器 ip</li> <li>PORT：ssh 的端口号，默认为 22</li> <li>SOURCE：<code>npm run build</code> 之后打包的文件路径，<strong>相对地址</strong>(我的是打包到 webView 文件夹)</li> <li>TARGET：服务器上需要上传到的文件路径，<strong>绝对地址</strong>(我的是上传到 /usr/web/html/blog 文件夹下)</li> <li>登录 Github，找到你要添加 Actions 的代码仓库，依次填入上述信息</li></ol> <img src="https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/git-2.png" alt="actions 设置图片"> <div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br></div><pre class="language-text"><code>name: Publish And Deploy Demo # 显示在 Github Actions 里面的名称

# 监听 master 分支的 push 事件，执行 jobs 里面的内容
on:
  push:
    branches:
      - master

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # 运行环境，告诉它运行在什么环境
    steps:
      # 第一步：下载源码（CI/CD拉取代码到自己的本地）
      - name: Checkout
        uses: actions/checkout@master # 切换到 master 分支

      # 第二步：添加node环境，不可缺失
      - name: Setup Node.js environment
        uses: actions/setup-node@v2

      # 第三步：打包构建
      - name: Build
        run: npm install &amp;&amp; npm run build

      # 第四步：部署到服务器
      - name: ssh deploy
        uses: easingthemes/ssh-deploy@v2.1.6
        env:
          SSH_PRIVATE_KEY: ${{ secrets.KEY }}
          REMOTE_HOST: ${{ secrets.HOST }}
          REMOTE_USER: ${{ secrets.USERNAME }}
          REMOTE_PORT: ${{ secrets.PORT }}
          SOURCE: 'webView/'
          TARGET: '/usr/web/html/blog'
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>将代码推到 Github 仓库，就会触发自定义的 workflow<br>
并将打包好的代码部署到服务器</p> <img src="https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/git-3.png" alt="actions 成功图片"></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=Git" title="标签">#Git</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/10/19, 09:16:49</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/6ddf53/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">CentOS7安装Nginx</div></a> <a href="/pages/667146/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Nginx的使用</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/6ddf53/" class="prev">CentOS7安装Nginx</a></span> <span class="next"><a href="/pages/667146/">Nginx的使用</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/eb693b/"><div>Serverless</div></a> <span>04-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/6ddf53/"><div>CentOS7安装Nginx</div></a> <span>03-28</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/34b5dd/"><div>常用cmd和linux命令</div></a> <span>03-26</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://www.zhihu.com/people/yrp-48/posts" title="知乎" target="_blank" class="iconfont iconshejiaotubiao-46"></a><a href="https://github.com/yrpyrp1116" title="GitHub" target="_blank" class="iconfont iconGitHub"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2021
    <span>尚天竹 | <a href="https://github.com/yrpyrp1116" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.1bf2a7df.js" defer></script><script src="/assets/js/2.ef1a646b.js" defer></script><script src="/assets/js/14.2eb2e1b7.js" defer></script>
  </body>
</html>